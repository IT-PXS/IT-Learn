---
title: MySQL（3-事务和日志）
tags: MySQL
categories: 数据库
cover: /img/index/mysql.png
top_img: /img/index/mysql.png
published: false
abbrlink: 63240
date: 2024-11-22 22:38:34
description:
---

在不破坏封闭的前提下，捕获一个对象的内部状态，并在该对象之外保存这个状态，这样以后就可将该对象恢复到原先保存的状态。该模式用于保存对象当前状态，并且在之后可以再次恢复到此状态。备忘录实现的方式需要保证被保存的对象状态不能被对象从外部访问

```java
public class Memento {
    private String state;

    public Memento(String state){
        this.state=state;
    }

    public String getState(){
        return state;
    }
}
```

```java
public class Originator {
    private String state;

    public void setState(String state){
        this.state=state;
    }

    public String getState(){
        return state;
    }

    public Memento saveStateToMemento(){
        return new Memento(state);
    }

    public void getStateFromMemento(Memento memento){
        state=memento.getState();
    }
}
```

```java
public class CareTaker {
    private List<Memento> mementoList=new ArrayList<>();

    public void add(Memento memento){
        mementoList.add(memento);
    }

    public Memento get(int index){
        return mementoList.get(index);
    }
}
```

```java
public class MementoPatternDemo {
    public static void main(String[] args) {
        Originator originator = new Originator();
        CareTaker careTaker = new CareTaker();
        originator.setState("State #1");
        originator.setState("State #2");
        careTaker.add(originator.saveStateToMemento());
        originator.setState("State #3");
        careTaker.add(originator.saveStateToMemento());
        originator.setState("State #4");

        System.out.println("Current State: "+originator.getState());
        originator.getStateFromMemento(careTaker.get(0));
        System.out.println("First saved State: "+originator.getState());
        originator.getStateFromMemento(careTaker.get(1));
        System.out.println("Second saved State: "+originator.getState());
    }
}
```



